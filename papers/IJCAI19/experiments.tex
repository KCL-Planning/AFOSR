%!TEX root=./main.tex


% pgf settings: shrink the tick labels a bit
\pgfplotsset{every tick label/.append style={font=\scriptsize}}

\newcommand{\scatterplotsize}{8cm}
\newcommand{\scatterplotxlabelshift}{1.5ex}
\newcommand{\scatterplotylabelshift}{-3ex}

\section{Experiments}

\rebecca{ 1-1.5 page(s) Michael/Rebecca }


\joerg{Ideally, we should actually do something with existing oversubscription 
	planning benchmarks. Carmel and Mirkis generated ones in their work 
	(http://iew3.technion.ac.il/~dcarmel/Papers/Sources/ecai14b.pdf), 
	from IPC benchmarks, by restricting plan cost to 25\%, 50\%, 75\%, and 100\% 
	of optimal plan cost for all goals. Emulate this, for unit action costs, 
	in a way that makes our current technology applicable.}

\joerg{	
	Question: what about the nogood learning here? does the search just prune 
	against the g function? or do we represent a discrete g function through a 
	discrete state variable treating it like a resource?}

\setlength{\tabcolsep}{1pt}
\renewcommand{\arraystretch}{0.8}
\begin{figure*}[ht]
	\centering
	\input{tables/coverage_IPC.tex}
	\caption{
		coverage: coverage of \emph{Goal-Fact Dependencies 1} computation as fraction of the instances solved by \emph{lmcut} without a cost bound in 30 min, 
		over the commonly solved instances:
		avg time: average time per node in meta search tree,
		\#gs: number of \emph{minimal unsolvable goal subsets},
		\#n: number of solved nodes in meta search tree,
		fn: fraction of solved nodes in the meta search tree with repect to the worst case size (all possible goal fact combinations $2^{\text{\# goal facts}}$, 
		Benchmark: oversubscription IPC 
		domains with bound $ = x \cdot $ optimal cost with $ x \in \{0.25, 0.5, 0.75\}$.
		C: online learned dead-end detectors with bounded DFS which are propagated 
		down the three, C nr: the learned heuristic is not reused, max: $h^{max}$ with $A^*$. 
		time-out 30 min}
\end{figure*}


\begin{figure}[ht]
	\scriptsize
	\begin{minipage}{0.5\textwidth}
		\input{data/IPC_cost_bound/scatterplot-expansions_C-Cnr_IPC_GFD_0.25.tex}
	\end{minipage}
	%\hfill
	%\begin{minipage}{0.2\textwidth}
	%	\input{data/IPC_cost_bound/scatterplot-search_time_C-Cnr_IPC_GFD_0.25.tex}
	%\end{minipage}
	\begin{minipage}{0.2\textwidth}
		\input{data/IPC_cost_bound/scatterplot-expansions_C-Cnr_IPC_GFD_0.5.tex}
	\end{minipage}
	\hfill
	\begin{minipage}{0.2\textwidth}
		\input{data/IPC_cost_bound/scatterplot-search_time_C-Cnr_IPC_GFD_0.5.tex}
	\end{minipage}
	\begin{minipage}{0.2\textwidth}
		\input{data/IPC_cost_bound/scatterplot-expansions_C-Cnr_IPC_GFD_0.75.tex}
	\end{minipage}
	\hfill
	\begin{minipage}{0.2\textwidth}
		\input{data/IPC_cost_bound/scatterplot-search_time_C-Cnr_IPC_GFD_0.75.tex}
	\end{minipage}

	\caption{Comparison of expansions and search time per task of $h^{C}$ with and 
	without the reuse of the heuristic for oversubscription IPC domains}
\end{figure}

\FloatBarrier
\subsubsection{Top Down vs. Bottom Up}
%\input{data/IPC_cost_bound/compare_td_bu/scatterplot-avg_search_time_td-bu_IPC_GFD_0.5.tex}


\begin{figure}[ht]
	\small
\begin{tabular}{l||rr||rr|rr||rr}
	& \multicolumn{2}{c}{0.25} & \multicolumn{4}{c}{0.5} & \multicolumn{2}{c}{0.75} \\\hline
		& tp c & bu & tp c & bu c & td fn & bu fn & td c & bu c \\\hline
		airport (28) & 24 & 25 & 19 & 21 & 0.71 & 0.67 & 19 & 21\\
		barman (4) & 4 & 4 & 4 & 4 & 0.88 & 0.88 & 4 & 4\\
		blocks (28) & 27 & 28 & 21 & 23 & 0.93 & 0.39 & 17 & 18\\
		data-network (12) & 12 & 12 & 12 & 12 & 0.65 & 0.60 & 12 & 12\\
		depot (7) & 7 & 7 & 7 & 7 & 0.91 & 0.52 & 4 & 4\\
		driverlog (13) & 13 & 13 & 10 & 11 & 0.86 & 0.58 & 8 & 9\\
		elevators (40) & 40 & 40 & 40 & 40 & 0.89 & 0.65 & 33 & 35\\
		floortile (13) & 6 & 7 & 2 & 2 & 0.80 & 0.67 & 2 & 2\\
		freecell (15) & 15 & 15 & 15 & 15 & 0.94 & 0.60 & 14 & 14\\
		ged (15) & 10 & 15 & 10 & 12 & 0.80 & 0.47 & 10 & 10\\
		grid (2) & 2 & 2 & 2 & 2 & 0.69 & 0.56 & 2 & 2\\
		gripper (7) & 5 & 7 & 4 & 5 & 0.88 & 0.65 & 5 & 4\\
		hiking (9) & 9 & 9 & 9 & 9 & 0.61 & 0.61 & 9 & 9\\
		logistics (26) & 22 & 25 & 15 & 18 & 0.84 & 0.68 & 12 & 12\\
		miconic (141) & 56 & 69 & 45 & 50 & 0.82 & 0.67 & 45 & 45\\
		mprime (22) & 22 & 22 & 22 & 22 & 0.59 & 0.59 & 22 & 22\\
		mystery (17) & 17 & 17 & 17 & 17 & 0.63 & 0.62 & 15 & 16\\
		nomystery (14) & 14 & 14 & 10 & 10 & 0.92 & 0.63 & 8 & 8\\
		openstacks (47) & 24 & 47 & 22 & 47 & 0.99 & 0.07 & 20 & 43\\
		parking (5) & 0 & 5 & 0 & 0 & - & - & 0 & 0\\
		pathways-noneg (5) & 5 & 5 & 4 & 4 & 0.77 & 0.64 & 4 & 4\\
		pipesworld-nt (17) & 17 & 17 & 16 & 17 & 0.84 & 0.69 & 16 & 16\\
		psr-small (49) & 48 & 48 & 48 & 47 & 0.55 & 0.86 & 47 & 46\\
		rovers (8) & 8 & 8 & 7 & 7 & 0.84 & 0.74 & 6 & 6\\
		satellite (7) & 7 & 7 & 6 & 6 & 0.94 & 0.49 & 4 & 5\\
		scanalyzer (27) & 9 & 9 & 9 & 9 & 0.86 & 0.53 & 9 & 9\\
		snake (7) & 1 & 3 & 1 & 2 & 0.91 & 0.24 & 1 & 1\\
		sokoban (50) & 49 & 50 & 47 & 48 & 0.73 & 0.80 & 42 & 43\\
		storage (15) & 15 & 15 & 15 & 15 & 0.75 & 0.75 & 15 & 15\\
		tetris (6) & 2 & 5 & 2 & 2 & 0.80 & 0.82 & 3 & 2\\
		tidybot (23) & 23 & 23 & 23 & 23 & 0.92 & 0.43 & 7 & 15\\
		tpp (7) & 7 & 7 & 6 & 7 & 0.83 & 0.59 & 6 & 6\\
		transport (23) & 23 & 23 & 23 & 23 & 0.88 & 0.59 & 23 & 23\\
		trucks (10) & 10 & 10 & 6 & 7 & 0.89 & 0.70 & 6 & 6\\
		zenotravel (13) & 12 & 13 & 8 & 9 & 0.89 & 0.66 & 8 & 8\\\hline
		Sum & 565 & 626 & 507 & 553 &  &  & 458 & 495\\
	\end{tabular}
	\caption{Comparison of coverage per cost bound for top-down vs bottom-up meta search.
	For cost-bound=0.5 there is (\#meta search nodes/maximinal number of meta search nodes) displayed.Planner $A^*$ with $h^{max}$}
	\rebecca{These are only preliminary results. There are still some domains missing because of a bug in 
		the bottom-up version. The missing domains are in favor of the top-down version.
		But the overall result should stay the same. Bottom-up often has to solve less nodes which can
	improve the coverage. Strongest difference in openstacks.}
\end{figure}


\begin{figure}[ht]
\input{data/IPC_cost_bound/compare_td_bu/scatterplot-num_nodes_td-bu_IPC_GFD_0.5.tex}
\caption{Comparison of the number of nodes in the meta search tree for the top-down and bottom-up meta search.
	Planner $A^*$ with $h^{max}$}
\end{figure}


\FloatBarrier
\newpage
\subsubsection*{Action Set Properties}

\begin{figure}[ht]
	\begin{tabular}{l|r|rrrrrrrrrr}
		& & \multicolumn{10}{c}{\# properties} \\
		domain & \#goals & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\\hline
		nomystery & 2 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10\\\hline
				& 3 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10\\\hline
				& 4 & 10 & 10 & 10 & 10 & 9 & 9 & 9 & 9 & 8 & 7\\\hline
				& 5 & 10 & 10 & 10 & 10 & 10 & 8 & 4 & 2 & 2 & 2\\\hline
				& 6 & 10 & 9 & 8 & 8 & 7 & 2 & 0 & 2 & 2 & 2\\\hline\hline
		openstacks & 1 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 1 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 2 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 3 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 4 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 5 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 6 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 7 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 8 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 9 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline\hline
		rovers & 2 & 10 & 10 & 10 & 10 & 10 & 8 & 5 & 2 & 2 &- \\\hline
				& 4 & 9 & 6 ยง & 6 & 2 & 0 & 0 & 0 & 0 & 0 & - \\\hline
				& 6 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - \\\hline 
				& 8 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - \\\hline 
				& 10 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - \\\hline 
				& 12 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - \\\hline 
				& 14 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - \\\hline 
				& 16 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - \\\hline 
				& 18 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - \\\hline\hline
		TPP & 3 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10\\\hline
			& 4 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10\\\hline
			& 5 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 8 & 3\\\hline
			& 6 & 10 & 10 & 10 & 10 & 10 & 8 & 3 & 1 & 1 & 1\\\hline


	\end{tabular}
	\caption{Coverage for $h^{max}$ and top-down meta-search, 10 instances per \# goals and \# properties combination.
	For nomystery and TPP is the size of the locations fixed to 6 locations respectively 5 markets and the fuel is the 
	minimal amount needed to solve the task.
	The original goal facts are hard goals and the property-goal-facts are soft-goals.}
\end{figure}

\rebecca{
	At least in nomystery it seams to be difficult to generated action set properties that can be satisfied if we use 
	a constraint of 1 for the fuel. Therefore in most cases the MUGS are simply all goal-facts + one property.
}


%\input{action_set_properties_experiments.tex}
