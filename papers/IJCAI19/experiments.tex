%!TEX root=./main.tex


% pgf settings: shrink the tick labels a bit
\pgfplotsset{every tick label/.append style={font=\scriptsize}}

\newcommand{\scatterplotsize}{8cm}
\newcommand{\scatterplotxlabelshift}{1.5ex}
\newcommand{\scatterplotylabelshift}{-3ex}

\section{Experiments}

\rebecca{ 1-1.5 page(s) Michael/Rebecca }


\joerg{Ideally, we should actually do something with existing oversubscription 
	planning benchmarks. Carmel and Mirkis generated ones in their work 
	(http://iew3.technion.ac.il/~dcarmel/Papers/Sources/ecai14b.pdf), 
	from IPC benchmarks, by restricting plan cost to 25\%, 50\%, 75\%, and 100\% 
	of optimal plan cost for all goals. Emulate this, for unit action costs, 
	in a way that makes our current technology applicable.}

\joerg{	
	Question: what about the nogood learning here? does the search just prune 
	against the g function? or do we represent a discrete g function through a 
	discrete state variable treating it like a resource?}

\setlength{\tabcolsep}{1pt}
\renewcommand{\arraystretch}{0.8}
\begin{figure*}[ht]
	\centering
	\input{tables/coverage_IPC.tex}
	\caption{
		coverage: coverage of \emph{Goal-Fact Dependencies 1} computation as fraction of the instances solved by \emph{lmcut} without a cost bound in 30 min, 
		over the commonly solved instances:
		avg time: average time per node in meta search tree,
		\#gs: average number of \emph{minimal unsolvable goal subsets},
		\#n: average number of solved nodes in meta search tree,
		fn: average fraction of solved nodes in the meta search tree with repect to the worst case size (all possible goal fact combinations $2^{\text{\# goal facts}}$, 
		Benchmark: oversubscription IPC 
		domains with bound $ = x \cdot $ optimal cost with $ x \in \{0.25, 0.5, 0.75\}$.
		C: online learned dead-end detectors with bounded DFS which are propagated 
		down the three, C nr: the learned heuristic is not reused, max: $h^{max}$ with $A^*$. 
		time-out 30 min}
\end{figure*}


\begin{figure}[ht]
	\scriptsize
	\begin{minipage}{0.5\textwidth}
		\input{data/IPC_cost_bound/scatterplot-expansions_C-Cnr_IPC_GFD_0.25.tex}
	\end{minipage}
	%\hfill
	%\begin{minipage}{0.2\textwidth}
	%	\input{data/IPC_cost_bound/scatterplot-search_time_C-Cnr_IPC_GFD_0.25.tex}
	%\end{minipage}
	\begin{minipage}{0.2\textwidth}
		\input{data/IPC_cost_bound/scatterplot-expansions_C-Cnr_IPC_GFD_0.5.tex}
	\end{minipage}
	\hfill
	\begin{minipage}{0.2\textwidth}
		\input{data/IPC_cost_bound/scatterplot-search_time_C-Cnr_IPC_GFD_0.5.tex}
	\end{minipage}
	\begin{minipage}{0.2\textwidth}
		\input{data/IPC_cost_bound/scatterplot-expansions_C-Cnr_IPC_GFD_0.75.tex}
	\end{minipage}
	\hfill
	\begin{minipage}{0.2\textwidth}
		\input{data/IPC_cost_bound/scatterplot-search_time_C-Cnr_IPC_GFD_0.75.tex}
	\end{minipage}

	\caption{Comparison of expansions and search time per task of $h^{C}$ with and 
	without the reuse of the heuristic for oversubscription IPC domains}
\end{figure}

%\FloatBarrier
%\subsubsection{Top Down vs. Bottom Up}
%\input{data/IPC_cost_bound/compare_td_bu/scatterplot-avg_search_time_td-bu_IPC_GFD_0.5.tex}


\begin{figure*}[ht]
	\small
	\centering
	\input{tables/coverage_td_vs_bu.tex}
	\caption{Comparison of coverage per cost bound for top-down vs bottom-up meta search.
	Additionally there is (\#meta search nodes/maximal number of meta search nodes) displayed as average over the commonly solved instances.
	Planner $A^*$ with $h^{max}$}
\end{figure*}


%\begin{figure}[ht]
%\input{data/IPC_cost_bound/compare_td_bu/scatterplot-num_nodes_td-bu_IPC_GFD_0.25.tex}
%\input{data/IPC_cost_bound/compare_td_bu/scatterplot-num_nodes_td-bu_IPC_GFD_0.5.tex}
%\input{data/IPC_cost_bound/compare_td_bu/scatterplot-search_time_td-bu_IPC_GFD_0.5.tex}
%\input{data/IPC_cost_bound/compare_td_bu/scatterplot-avg_search_time_td-bu_IPC_GFD_0.5.tex}
%\caption{Comparison of the number of nodes in the meta search tree for the top-down and bottom-up meta search.
%	Planner $A^*$ with $h^{max}$. Axis: log base 2.}
%\end{figure}


\FloatBarrier
\newpage
\subsubsection*{Action Set Properties}

\begin{figure}[ht]
	\begin{tabular}{l|r|rrrrrrrrrr}
		& & \multicolumn{10}{c}{\# properties} \\
		domain & \#goals & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\\hline
		nomystery & 2 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10\\\hline
				& 3 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10\\\hline
				& 4 & 10 & 10 & 10 & 10 & 9 & 9 & 9 & 9 & 9 & 9\\\hline
				& 5 & 10 & 10 & 10 & 10 & 10 & 9 & 7 & 6 & 2 & 2\\\hline
				& 6 & 10 & 10 & 10 & 8 & 8 & 8 & 4 & 0 & 0 & 0\\\hline\hline
		openstacks & 1 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 1 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 2 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 3 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 4 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 5 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 6 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 7 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 8 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline
				& 9 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & - \\\hline\hline
		rovers & 2 & 10 & 10 & 10 & 10 & 10 & 8 & 5 & 2 & 2 &- \\\hline
				& 4 & 9 & 6 ยง & 6 & 2 & 0 & 0 & 0 & 0 & 0 & - \\\hline
				& 6 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - \\\hline 
				& 8 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - \\\hline 
				& 10 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - \\\hline 
				& 12 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - \\\hline 
				& 14 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - \\\hline 
				& 16 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - \\\hline 
				& 18 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - \\\hline\hline
		TPP & 3 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10\\\hline
			& 4 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10\\\hline
			& 5 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 8 & 3\\\hline
			& 6 & 10 & 10 & 10 & 10 & 10 & 8 & 3 & 1 & 1 & 1\\\hline


	\end{tabular}
	\caption{Coverage for $h^{max}$ and top-down meta-search, 10 instances per \# goals and \# properties combination.
	For nomystery and TPP is the size of the locations fixed to 6 locations respectively 5 markets and the fuel is the 
	minimal amount needed to solve the task.
	The original goal facts are hard goals and the property-goal-facts are soft-goals.}
\end{figure}

\rebecca{Example}
\begin{figure}
	Nomystery: fuel 1.5 * minimal,
	
	$fuel(T_0) = 16$, $fuel(T_1) = 7$
	\begin{center}
	\begin{tikzpicture}
		\node[draw, circle, label=above:{$I:P_0, P_1,P_2$}] (l0) at (0,0) {$L_0$};
		\node[draw, circle, label=right:{$T_1$}] (l1) at (4,-1) {$L_1$};
		\node[draw, circle] (l2) at (6,0) {$L_2$};
		\node[draw, circle, label=right:{$P_1$}] (l3) at (6,-3) {$L_3$};
		\node[draw, circle, label=below:{$P_0$}] (l4) at (2,-2) {$L_4$};
		\node[draw, circle, label=below:{$T_0~P_2$}] (l5) at (0,-3) {$L_5$};

		\draw[thick] (l0) to node[above] {5} (l2);
		\draw[thick] (l0) to node[above] {2} (l1);
		\draw[thick] (l0) to node[above] {3} (l4);
		\draw[thick] (l0) to node[left] {4} (l5);
		\draw[thick] (l2) to node[right] {1} (l3);
		\draw[thick] (l4) to node[above] {2} (l1);
		\draw[thick] (l4) to node[above] {5} (l3);
		\draw[thick] (l5) to node[below] {5} (l3);
	\end{tikzpicture}
	\end{center}
	\begin{minipage}[t]{0.2\textwidth}
	Properties:
	\begin{enumerate}
		\item block $T_0$ $(L_1,L_5)$
		\item force $T_0$ $(L_1,L_4)$
		\item block $T_1$ $(L_0,L_4)$
		\item same truck $P_0$ $P_1$
		\item same truck $P_1$ $P_2$
		\item force $T_0$ $(L_3,L_4)$
	\end{enumerate}
	\end{minipage}
	\begin{minipage}[t]{0.2\textwidth}
		MUGS:
		\begin{itemize}
			\item $\{6,5,1\}$
			\item $\{4,5,1\}$
		\end{itemize}
	\end{minipage}
\end{figure}

\begin{figure*}[ht]
	\centering
	nomystery
	\includegraphics[scale=0.2]{data/action_set_properties/coverage_nomystery.pdf}
	\caption{Comparison of coverage with respect to fuel bound (column, bound=xxx means x.xx times the minimal fuel), number of goal facts (row)
		, number of properties (x-axis)}
\end{figure*}
